## Issue Found

The Circle API response is wrapped in a `data` object and uses different property names:
- `id` instead of `transactionId`
- `state` instead of `status`

## Fix for CircleService.cs ExecuteDeveloperTransferAsync method

Replace lines 451-462 with:

```csharp
        // Execute request with custom parsing (Circle wraps response in "data" object)
        var rawResponse = await _retryPolicy.ExecuteAsync(async () =>
            await _client.ExecuteAsync(restRequest, cancellationToken));

        if (!rawResponse.IsSuccessful)
        {
            _logger.LogError(
                "Circle API request failed. StatusCode: {StatusCode}, Error: {Error}, Content: {Content} [CorrelationId: {CorrelationId}]",
                rawResponse.StatusCode,
                rawResponse.ErrorMessage,
                rawResponse.Content,
                correlationId);

            throw new HttpRequestException(
                $"Circle API request failed with status {rawResponse.StatusCode}: {rawResponse.ErrorMessage ?? rawResponse.Content}");
        }

        _logger.LogDebug("Circle API Raw Response: {Content} [CorrelationId: {CorrelationId}]",
            rawResponse.Content, correlationId);

        // Parse nested response: { "data": { "id": "...", "state": "...", ... } }
        var jsonDoc = System.Text.Json.JsonDocument.Parse(rawResponse.Content ?? "{}");
        var dataElement = jsonDoc.RootElement.GetProperty("data");

        // Map Circle's field names to our model (id -> TransactionId, state -> Status)
        var response = new CircleTransactionResponse
        {
            TransactionId = dataElement.TryGetProperty("id", out var idProp) ? idProp.GetString() ?? string.Empty : string.Empty,
            Status = dataElement.TryGetProperty("state", out var stateProp) ? stateProp.GetString() ?? string.Empty : string.Empty,
            TxHash = dataElement.TryGetProperty("txHash", out var txHashProp) ? txHashProp.GetString() : null,
            Blockchain = dataElement.TryGetProperty("blockchain", out var blockchainProp) ? blockchainProp.GetString() ?? string.Empty : string.Empty,
            From = dataElement.TryGetProperty("sourceAddress", out var fromProp) ? fromProp.GetString() ?? string.Empty : string.Empty,
            To = dataElement.TryGetProperty("destinationAddress", out var toProp) ? toProp.GetString() ?? string.Empty : string.Empty,
            TokenAddress = dataElement.TryGetProperty("tokenId", out var tokenProp) ? tokenProp.GetString() : null
        };

        // Parse amounts array
        if (dataElement.TryGetProperty("amounts", out var amountsProp) && amountsProp.ValueKind == System.Text.Json.JsonValueKind.Array)
        {
            var amountsArray = amountsProp.EnumerateArray().ToList();
            if (amountsArray.Count > 0)
            {
                response.Amount = amountsArray[0].GetString() ?? string.Empty;
            }
        }

        // Parse timestamps
        if (dataElement.TryGetProperty("createDate", out var createProp) && createProp.TryGetDateTime(out var createDate))
        {
            response.CreatedAt = createDate;
        }
        if (dataElement.TryGetProperty("updateDate", out var updateProp) && updateProp.TryGetDateTime(out var updateDate))
        {
            response.UpdatedAt = updateDate;
        }

        _logger.LogInformation(
            "Developer transfer executed. TransactionId: {TransactionId}, Status: {Status} [CorrelationId: {CorrelationId}]",
            response.TransactionId,
            response.Status,
            correlationId);

        return response;
```

## Fix for CircleTransactionMonitoringService.cs

The monitoring service filters for transactions starting with "transaction-", but empty TransactionIds won't match.

Update line 66-71 to handle empty transaction IDs:

```csharp
        // Get all pending Circle transactions (POL transfers)
        var pendingTransactions = await db.Transactions
            .Where(t => t.Status == "Pending" &&
                       t.Currency == "POL" &&
                       (t.TransactionId == null || t.TransactionId == "" || t.TransactionId.Length < 10))
            .ToListAsync(cancellationToken);
```

This will catch transactions with empty or missing transaction IDs and mark them as failed in the monitoring loop.
